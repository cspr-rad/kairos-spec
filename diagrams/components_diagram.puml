@startuml
node "WebClient" {
}

node "CliClient" {
}

node "ApiServer" {
  port a443
  () "deposit"
  () "withdraw"
  () "transfer"
  () "verify"
  () "getBalance"
  () "getTransactions"
}

node "Prover" {
  port p443
  [proverlib] -up-> () "prove"
  [proverlib] -up-> () "pVerify"
}

database "Postgres - primary" {
  folder "Balances" {
  }
  folder "Transactions" {
  }
}
database "Postgres - standby 1" {
}
database "Postgres - standby 2" {
}
cloud "Casper Blockchain" {
  [VerifierContract]
  [ValidiumStateContract]
}

"WebClient" --> "a443"

"CliClient" --> "a443"
"CliClient" --> "prove"
"CliClient" --> "Casper Blockchain"

"transfer" --> "p443"
"transfer"  --> "Postgres - primary"
"transfer"  --> "ValidiumStateContract"

"deposit"  --> "ValidiumStateContract"
"deposit"  --> "Postgres - primary"

"withdraw"  --> "ValidiumStateContract"
"withdraw"  --> "Postgres - primary"

"verify" --> "pVerify"

"getBalance"  --> "Postgres - primary"

"getTransactions"  --> "Postgres - primary"

"Postgres - primary" --> "Postgres - standby 1"
"Postgres - primary" --> "Postgres - standby 2"

"ValidiumStateContract" --> "VerifierContract"
@enduml
